(function(h){var j=function(k,m){this.done=false;this.xhr=k;var l=this;this.abort=function(){if(this.done){return}this.xhr.abort();this.done=true;e("abort",b)};this.xhr.onreadystatechange=function(){if(l.xhr.readyState==4){l.done=true;m(l.xhr.status)}}};var i="/api";var d="";var a="fr_FR";var c=function(l,k){console.log("[API]["+l+"] "+k);e("error",l,k)};var g={error:[],loading:[],loaded:[],abort:[]};var e=function(l,o,n,m){if(!g.hasOwnProperty(l)){return false}for(var k=0;k<g[l].length;k++){g[l][k](o,n,m)}return true};var b={};b.setLang=function(k){a=k};b.setToken=function(k){d=k};var f=function(l,m){var n=[],k=0;if(m.constructor===Array){for(k=0;k<m.length;k++){if(m.hasOwnProperty(k)){n.push(f(l+"["+k+"]",m[k]))}}return n.join("&")}else{if(typeof m=="object"){for(k in m){if(m.hasOwnProperty(k)){n.push(f(l+"["+k+"]",m[k]))}}return n.join("&")}else{return l+"="+encodeURIComponent(m+"")}}};b.call=function(s,r,o,n){if(!o){o={}}if(typeof n!="object"){n={any:n}}if(r.substr(0,1)!="/"){r="/"+r}e("loading",b);var m;if(window.XMLHttpRequest){m=new XMLHttpRequest()}else{m=new ActiveXObject("Microsoft.XMLHTTP")}var k=i+r;if(s=="GET"){var q=[];for(var l in o){q.push(f(l,o[l]))}if(q.length){k+="?"+q.join("&")}}m.open(s,k,true);m.setRequestHeader("Content-Type","application/json");m.setRequestHeader("Accept","application/json");m.setRequestHeader("X-Token",d);m.setRequestHeader("X-Lang",a);if(s=="GET"){m.send()}else{m.send(JSON.stringify(o))}var q=null;(function(p){q=new j(p,function(w){e("loaded",b);var u=JSON.parse(p.responseText);if(u.error&&u.error_message){c(u.error,u.error_message)}var v=p.getResponseHeader("X-Token");if(v){b.setToken(v)}if(n.hasOwnProperty(w)&&n[w]){n[w](u)}else{if(n.hasOwnProperty("any")&&n.any){n.any(u)}}})})(m);return q};b.get=function(m,l,k){return b.call("GET",m,l,k)};b.post=function(m,l,k){return b.call("POST",m,l,k)};b.put=function(m,l,k){return b.call("PUT",m,l,k)};b.patch=function(m,l,k){return b.call("PATCH",m,l,k)};b["delete"]=function(l,k){return b.call("DELETE",l,{},k)};b.on=function(k,l){if(!g.hasOwnProperty(k)){return false}g[k].push(l);return true};h.api=b})(window);